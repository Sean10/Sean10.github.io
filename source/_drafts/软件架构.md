---
title: 软件架构
subtitle: software
date: 2018-10-08 22:05:59
updated:
tags: [软件工程, 架构]
categories: [专业]
---

最近在公司里，多次遇到需要画UML图、架构图的情况，这个时候总有些迷茫，不知道有没有什么规范可以帮助完成。

<!--more-->

RUP(Rational统一过程)， 结构化系统分析与设计方法(SSADM)

可以抛弃，但是一定要足够好的草图



4+1视图分析是什么？



整个软件开发的生命周期中，会进行多种测试。

那么架构，能不能测试呢？

架构是要在持续交付的过程中，逐渐调整的。

# 设计过程

## 功能需求（Scrum产品订单)
敏捷软件开发的方法学






## 质量属性(非功能需求)

1. 捕捉
2. 提炼

比如，用户数、数据量、最大响应时间，都是需要从甲方那里提炼出来的

给甲方提出成本，可以有助于集中注意力，如果成本在甲方承受范围外，那么有些性能上就可以做出让步，需要从甲方那里得到这部分最重要的优先级。
## 约束

1. 标准的技术清单

的确，在公司里想要使用的软件，都需要提出正式申请，而不能像自己开发时那样随意。

2. 现有系统的互操作性

3. 技术成熟度

4. 开源代码接收程度

5. 内部知识产权

但是约束之间也是存在优先级的，可以进行让步

## 理解影响

技术解耦时，总有一个更重要的决策点。

比如使用ORM，解耦了数据库选择，那么ORM选择就很重要




# 绘图的C4(语境、容器、组件和类)
这里的容器主要是指组成软件系统的逻辑上的可执行文件或过程
* Web服务器(如Apache HTTP服务器)
* 应用服务器
* SQL数据库
* 文件系统

## 容器
### 交互
容器间的交互往往是进程间通信。需要写上以下一些有用的信息：
* 交互的目的(如“读/写数据”、“发送报告”)
* 通信方法（如Web服务、REST、Java远程方法调用、Windows通信基础、Java消息服务)
* 通信方式(如同步、异步、批量、两阶段提交等);
* 协议和端口号(如HTTP、HTTPS、SOAP/HTTP、SMTP、FTP、RMI/IIOP等)


## 组件
### 交互
* 交互的目的
* 通信方式

## 图应该反映现实


## 我们讨论组件但编写类

## 用层封装代码
当使用一种面向对象的编程语言，在讨论架构时，我们有没有讨论对象呢？

书上说是讨论的往往是组件和服务之类的概念，结果架构图中的组件实际上是由多个层上的类组合实现的。比如，你可能会发现有一个组件有一部分在“服务”包里，其他部分则在“数据访问”包里。

为了做到这一点，较低层的代码（比如 数据访问）往往是公开课件的，这也意味着能被架构中其他层直接调用

## 用特性封装

基于功能的垂直切片来组织代码

Mark Needham有一篇文章 Coding: Packaging by vertical slice

以特性封装和以层封装

在github上，je.techtribes， component.tweet这个包

看上去很像以特性来封装，但更类似上面那篇文中中提到的微服务

松耦合组件组成的分布式消息系统，很像


逆向工程，可以从代码生成UML图

# 原则
* 遵循SOLID(单一职责原则、开闭原则、里氏代换原则、接口隔离原则、依赖倒置原则)
* DRY(don't repeat yourself)
* 始终选择存储过程
* 绝不使用存储过程
* 不要重新发明轮子
* 错误处理、日志等的通用方法


# 外部接口
关键的外部接口
* 你的系统和其他系统之间的(不管在环境内部还是外部)
* 暴露出来用来消费的API
* 从系统导出的文件

每个接口都从技术角度考虑过了吗？
* 接口的技术定义是什么？
* 如果使用了消息，哪些队列(点对点)和话题(发布-订阅)是用于通信的组件？
* 消息的格式是什么(比如，纯文本或DTD/Schema定义的XML)
* 同步还是异步?
* 异步消息的连接有保障吗？
* 如果必要，人们会长期订阅吗？
* 消息能否打乱顺序接收，这会造成问题吗？
* 接口是否幂等?
* 接口是否总是可用，或者说你是否需要在本地缓存数据？
* 性能/可伸缩性/安全性/其他是如何满足的

每个接口都从非技术角度考虑过了?

* 接口所有权属谁
* 接口多久会有变化，版本怎么处理?
* 是否有服务级别的协议

结构？

倾向于简单的（以"从X到Y")列出接口，附上一小段描述接口特征的叙述。为了在语境中理解这些接口，我会包含一个强调接口的简化版容器或组件图。

# 代码
## 意图
* 生成/渲染HTML: 对生成HTML的内部框架的简短描述，包括主要的类和概念。
* 数据绑定:根据HTTP POST请求更新业务对象的方法。
* 多页数据采集: 简短描述构建跨网页表单的内部框架
* Web MVC: 正在使用的Web MVC框架的一个使用示例。
* 安全性: 使用Windows身份基础(WIF)进行认证和授权的方法
* 域模型: 域模型重要部分的概览。
* 组件框架: 简短描述为了在运行时重新配置组件而构建的框架
* 配置: 简短描述代码库中使用的标准组件配置机制。
* 架构分层: 分层策略和用来实现的模式的概览。
* 异常和日志: 总结在各个架构分层中处理异常和记录日志的方法。
* 模式和原则: 解释*模式和原则*如何实现。

# 数据
## 意图
* 数据模型看起来是什么样？
* 数据存储在哪里
* 谁拥有数据
* 数据需要多少存储空间(比如，特别如果你在处理大数据)
* 归档和备份策略是什么？
* 业务数据的长期归档是否有法规要求
* 日志文件和审计跟踪是否有类似的要求
* 是否用简单文件来存储，如果是，用的是哪种格式

# 部署
## 意图
描述软件（比如容器）和基础设施之间的映射。有时候这是简单的一对一映射)比如，把一个Web应用程序部署到单个Web服务器上），其他时候会更复杂（比如，把一个Web应用程序部署到服务器集群的多个服务器上）。

* 软件安装和配置软件在哪里，怎么坐？
* 软件如何部署到基础设施架构部分描述的基础设施元素上是否清楚
* 如果这仍待决定，有哪些选项，是否做了文档？
* 内存和CPU在运行于单块基础设施上的进程间如何分配是否清楚？
* 有容器后组件以主动-主动、主动、被动、热备用、冷备用等形态运行吗？
* 部署和回滚策略是否已经定义
* 软件或基础设施出击故障时会发生什么？
* 跨站点的数据如何复制是否清楚

# 开发声明周期中的软件架构

